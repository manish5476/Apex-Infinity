
@use 'sass:map';
@use 'sass:math';

/* --- Breakpoints map --- */
$breakpoints: (
  xs: 0px,
  sm: 576px,
  md: 768px,
  lg: 992px,
  xl: 1200px,
  xxl: 1400px
);

/* --- Media query mixin --- */
@mixin respond-to($label) {
  $size: map.get($breakpoints, $label);
  @if $size != null {
    @media (min-width: $size) {
      @content;
    }
  } @else {
    @warn "Unknown breakpoint: #{$label}";
    @content;
  }
}

/* --- Utility functions for spacing scale --- */
$space-scale: (
  xs: var(--spacing-sm),
  sm: var(--spacing-md),
  md: calc(var(--spacing-md) * 1.5),
  lg: var(--spacing-lg),
  xl: calc(var(--spacing-lg) * 2)
);

@function space($key) {
  @return map.get($space-scale, $key);
}

/* ==== Existing small utilities (preserve and extend) ==== */
.m-0 { margin: 0 !important; }
.mt-md { margin-top: var(--spacing-md); }
.p-md { padding: var(--spacing-md); }

.flex { display: flex; }
.flex-center { display: flex; align-items: center; justify-content: center; }
.text-center { text-align: center; }

/* Card baseline (replaces previous static card) */
.card {
  background: color-mix(in srgb, var(--background-color) 100%, transparent);
  border-radius: var(--border-radius);
  box-shadow: var(--elevation-1);
  padding: var(--spacing-md);
  color: var(--text-color);
}

/* --- Spacing helpers (shorthand) --- */
@each $k, $v in $space-scale {
  .p-#{$k} { padding: $v !important; }
  .pt-#{$k} { padding-top: $v !important; }
  .pb-#{$k} { padding-bottom: $v !important; }
  .pl-#{$k} { padding-left: $v !important; }
  .pr-#{$k} { padding-right: $v !important; }

  .m-#{$k} { margin: $v !important; }
  .mt-#{$k} { margin-top: $v !important; }
  .mb-#{$k} { margin-bottom: $v !important; }
  .ml-#{$k} { margin-left: $v !important; }
  .mr-#{$k} { margin-right: $v !important; }
}

/* --- Flex helpers --- */
.row-center { display: flex; align-items: center; justify-content: center; gap: var(--spacing-md); }
.col-center { display: flex; flex-direction: column; align-items: center; gap: var(--spacing-md); }
.flex-gap-sm { gap: var(--spacing-sm); }
.flex-gap-md { gap: var(--spacing-md); }

/* --- Utilities for alignment (inline) --- */
.align-start { align-items: flex-start; }
.align-center { align-items: center; }
.justify-between { justify-content: space-between; }
.justify-end { justify-content: flex-end; }

/* --- Elevation helper (parametric) --- */
@mixin elevation($level: 1) {
  @if $level == 1 { box-shadow: var(--elevation-1); }
  @else if $level == 2 { box-shadow: var(--elevation-2); }
  @else if $level == 3 { box-shadow: var(--elevation-3); }
  @else { box-shadow: var(--elevation-1); }
}

/* handy elevation classes */
.raise-1 { @include elevation(1); }
.raise-2 { @include elevation(2); }
.raise-3 { @include elevation(3); }

/* --- Header / toolbar styles --- */
.header {
  display: flex;
  align-items: center;
  justify-content: space-between;
  padding: calc(var(--spacing-sm) / 2) var(--spacing-md);
  gap: var(--spacing-md);
  background: transparent;
  border-bottom: 1px solid color-mix(in srgb, var(--text-color) 8%, transparent);
}

.header .title {
  font-weight: 700;
  font-size: 1rem;
}

/* --- Filter / control panel --- */
.filter {
  display: flex;
  gap: var(--spacing-sm);
  align-items: center;
  padding: calc(var(--spacing-sm) / 2) var(--spacing-sm);
  border-radius: calc(var(--border-radius) / 2);
  border: 1px solid color-mix(in srgb, var(--text-color) 6%, transparent);
}

/* Backdrop filter support with graceful fallback */
.u-glass {
  background: color-mix(in srgb, var(--background-color) 85%, transparent);
  @supports (backdrop-filter: blur(6px)) or (-webkit-backdrop-filter: blur(6px)) {
    backdrop-filter: blur(6px);
    -webkit-backdrop-filter: blur(6px);
    background: color-mix(in srgb, var(--background-color) 60%, transparent);
  }
}

/* --- Pills / chips --- */
.pill {
  display: inline-flex;
  gap: var(--spacing-sm);
  align-items: center;
  padding: calc(var(--spacing-sm) / 1.25) calc(var(--spacing-md) / 1.25);
  border-radius: 999px;
  font-size: 0.875rem;
  background: color-mix(in srgb, var(--primary-color) 6%, transparent);
  color: var(--text-color);
  border: 1px solid color-mix(in srgb, var(--text-color) 6%, transparent);
}

/* --- Badge variations --- */
.badge-muted { background: color-mix(in srgb, var(--text-color) 6%, transparent); color: var(--text-color); }
.badge-primary { background: var(--primary-color); color: #fff; }

/* --- Modal base (used by dialogs) --- */
.modal {
  position: fixed;
  inset: 0;
  display: grid;
  place-items: center;
  z-index: 2000;
  padding: var(--spacing-md);
}
.modal .sheet {
  width: 100%;
  max-width: 720px;
  border-radius: var(--border-radius);
  padding: var(--spacing-md);
  background: color-mix(in srgb, var(--background-color) 100%, transparent);
  color: var(--text-color);
  @include elevation(3);
}

/* --- Responsive helpers --- */
.hide-xs { display: none !important; }
.show-sm { display: none; }
@include respond-to(sm) {
  .show-sm { display: block; }
}

/* --- Utility: truncate text --- */
.truncate {
  overflow: hidden;
  text-overflow: ellipsis;
  white-space: nowrap;
}

/* --- Visually hidden for screen readers --- */
.visually-hidden {
  position: absolute !important;
  height: 1px;
  width: 1px;
  overflow: hidden;
  clip: rect(1px, 1px, 1px, 1px);
  white-space: nowrap;
}

/* --- Form helpers: consistent form control spacing --- */
.form-field {
  display: flex;
  flex-direction: column;
  gap: calc(var(--spacing-sm) / 2);
}
.form-inline { display: flex; gap: var(--spacing-md); align-items: center; }

/* --- Tiny utility for sortable column indicator --- */
.sort-indicator {
  display: inline-flex;
  align-items: center;
  gap: 6px;
  font-size: 0.85rem;
}

/* --- Print helpers --- */
@media print {
  .no-print { display: none !important; }
  .print-block { display: block !important; }
}

/* --- Additional helpers that enterprise apps often use --- */
/* sticky sidebars & float helpers */
.sticky {
  position: sticky;
  top: var(--spacing-md);
}

/* helper to visually differentiate empty states */
.empty-state {
  display: flex;
  align-items: center;
  justify-content: center;
  gap: var(--spacing-md);
  padding: var(--spacing-lg);
  border-radius: var(--border-radius);
  border: 1px dashed color-mix(in srgb, var(--text-color) 6%, transparent);
  color: color-mix(in srgb, var(--text-color) 60%, transparent);
}

/* small helper to vertically center within cards or other containers */
.v-center {
  display: flex;
  align-items: center;
  justify-content: center;
}

/* End of common.scss */
