<div class="header-inner">
  <div class="header-left">
    <button class="menu-toggle-btn" (click)="onMenuToggle()">
      <i class="pi pi-bars"></i>
    </button>
    <a routerLink="/dashboard" class="logo-link">
      <img src="assets/apex-infinity-logo.svg" alt="Apex Infinity" class="logo-image">
      <span class="logo-text">Apex Infinity</span>
    </a>
  </div>

  <div class="header-right">
    <button (click)="showNotificationDialog = true" class="notification-btn"
      [class.has-new]="recentNotifications.length > 0" pTooltip="Notifications" tooltipPosition="bottom">
      <i class="pi pi-bell"></i>
      @if (recentNotifications.length > 0) {
      <span class="notification-count">{{ recentNotifications.length }}</span>
      }
    </button>

    @if (currentUser) {
    <button class="user-profile-trigger" (click)="showProfileDialog = true" pTooltip="Profile & Settings"
      tooltipPosition="bottom">
      <p-avatar [label]="getInitials(currentUser?.name)" shape="circle" size="normal"
        [style]="{'background-color': 'var(--accent-primary)', 'color': '#fff', 'font-weight': '600'}">
      </p-avatar>
      <div class="user-meta hidden md:flex">
        <span class="name">{{ currentUser?.name }}</span>
        <span class="role">{{ currentUser?.role.name || 'Admin' }}</span>
      </div>
      <i class="pi pi-chevron-down text-xs ml-1"></i>
    </button>
    }
    @else {
    <a routerLink="/auth/login" class="login-btn">
      <i class="pi pi-sign-in"></i>
      <span>Login</span>
    </a>
    }

  </div>
</div>

<!-- PROFILE & SETTINGS DIALOG -->
<p-dialog [(visible)]="showProfileDialog" [modal]="true" [draggable]="false" [resizable]="false" appendTo="body"
  [dismissableMask]="true" [showHeader]="false" styleClass="profile-dialog" [style]="{ 
    width: '90vw', 
    maxWidth: '89vw',
    minHeight: '85vh',
    maxHeight: '90vh',
    borderRadius: '20px', 
    overflow: 'hidden'
  }" maskStyleClass="backdrop-blur-sm bg-black/40" (onHide)="showProfileDialog = false">

  <div class="dialog-container">
    <!-- User Profile Header -->
    <div class="dialog-header">
      <div class="user-profile-section">
        <p-avatar [label]="getInitials(currentUser?.name)" shape="circle" size="xlarge"
          [style]="{'background-color': 'var(--accent-primary)', 'color': '#fff', 'font-weight': '700'}">
        </p-avatar>
        <div class="user-info">
          <h3 class="user-name">{{ currentUser?.name }}</h3>
          <p class="user-email">{{ currentUser?.email }}</p>
          <div class="user-badges">
            <span class="role-badge">
              <i class="pi pi-shield"></i>
              {{ currentUser?.role.name || 'Admin' }}
            </span>
            <span class="status-badge">
              <i class="pi pi-circle-fill"></i>
              Online
            </span>
          </div>
        </div>
        <button class="close-dialog-btn" (click)="showProfileDialog = false">
          <i class="pi pi-times"></i>
        </button>
      </div>
    </div>

    <!-- Dialog Tabs -->
    <div class="dialog-tabs">
      <div class="tabs-container">
        <button class="tab-btn" [class.active]="activeDialogTab === 'settings'" (click)="activeDialogTab = 'settings'">
          <i class="pi pi-cog"></i>
          <span>Settings</span>
        </button>
        <button class="tab-btn" [class.active]="activeDialogTab === 'notifications'"
          (click)="activeDialogTab = 'notifications'">
          <i class="pi pi-bell"></i>
          <span>Notifications</span>
          @if (recentNotifications.length > 0) {
          <span class="tab-badge">{{ recentNotifications.length }}</span>
          }
        </button>
      </div>
    </div>

    <!-- Scrollable Content Area -->
    <div class="dialog-content" #dialogContent>
      @if (activeDialogTab === 'settings') {
      <div class="settings-content">

        <!-- Theme Section -->
        <div class="section-card">
          <div class="section-header">
            <h5 class="section-title">
              <i class="pi pi-palette"></i>
              <span>Theme & Appearance</span>
            </h5>
            <div class="dark-mode-toggle">
              <span class="toggle-label">Dark Mode</span>
              <p-toggleButton [(ngModel)]="isDarkMode" onIcon="pi-moon" offIcon="pi pi-sun"
                [style]="{'width': '3.5rem', 'height': '1.75rem'}" (onChange)="toggleDarkMode($event.checked)">
              </p-toggleButton>
            </div>
          </div>

          <!-- Theme Presets Grid -->
          <div class="theme-presets-section">
            <h6 class="section-subtitle">Quick Presets</h6>
            <div class="theme-presets-grid">
              @for (preset of themePresets; track preset.id) {
              <div class="preset-card" [class.active]="activeThemeId === preset.id" (click)="selectTheme(preset.id)">
                <div class="preset-preview" [style.background]="preset.gradient">
                  <div class="preset-preview-content">
                    <div class="preview-bar"></div>
                    <div class="preview-bar short"></div>
                    <div class="preview-bar medium"></div>
                  </div>
                  @if (activeThemeId === preset.id) {
                  <div class="active-check">
                    <i class="pi pi-check"></i>
                  </div>
                  }
                </div>
                <span class="preset-name">{{ preset.name }}</span>
              </div>
              }
            </div>
          </div>

          <!-- Accent Colors -->
          <div class="accent-colors-section">
            <h6 class="section-subtitle">Accent Colors</h6>
            <div class="accent-colors-grid">
              @for (color of accentColors; track color.name) {
              <div class="color-option" (click)="setAccentColor(color.value)">
                <div class="color-circle" [style.background]="color.value"></div>
                <span class="color-name">{{ color.name }}</span>
              </div>
              }
            </div>
          </div>
        </div>

        <!-- Quick Actions -->
        <div class="section-card quick-actions-card">
          <h5 class="section-title">
            <i class="pi pi-bolt"></i>
            <span>Quick Actions</span>
          </h5>
          <div class="actions-grid">
            <button class="action-item" (click)="randomTheme()">
              <div class="action-icon random-theme">
                <i class="pi pi-random"></i>
              </div>
              <span>Random Theme</span>
            </button>
            <button class="action-item" (click)="resetToDefault()">
              <div class="action-icon reset-default">
                <i class="pi pi-replay"></i>
              </div>
              <span>Reset Default</span>
            </button>
          </div>
        </div>

        <!-- Account Management -->
        <div class="section-card account-section">
          <h5 class="section-title">
            <i class="pi pi-user"></i>
            <span>Account Management</span>
          </h5>
          <div class="account-links">
            <a routerLink="/profile" class="account-link" (click)="showProfileDialog = false">
              <div class="link-icon profile">
                <i class="pi pi-user-edit"></i>
              </div>
              <div class="link-content">
                <span class="link-title">Profile Settings</span>
                <span class="link-subtitle">Update personal information</span>
              </div>
              <i class="pi pi-chevron-right link-arrow"></i>
            </a>
            <a routerLink="/security" class="account-link" (click)="showProfileDialog = false">
              <div class="link-icon security">
                <i class="pi pi-shield"></i>
              </div>
              <div class="link-content">
                <span class="link-title">Security</span>
                <span class="link-subtitle">Password & 2FA settings</span>
              </div>
              <i class="pi pi-chevron-right link-arrow"></i>
            </a>
            <a routerLink="/billing" class="account-link" (click)="showProfileDialog = false">
              <div class="link-icon billing">
                <i class="pi pi-credit-card"></i>
              </div>
              <div class="link-content">
                <span class="link-title">Billing</span>
                <span class="link-subtitle">Manage subscription</span>
              </div>
              <i class="pi pi-chevron-right link-arrow"></i>
            </a>
          </div>
        </div>

        <!-- Sign Out Button -->
        <button class="signout-btn" (click)="logout(); showProfileDialog = false">
          <i class="pi pi-power-off"></i>
          <span>Sign Out</span>
        </button>

      </div>
      }

      @if (activeDialogTab === 'notifications') {
      <div class="notifications-content">
        <div class="notifications-header">
          <h5>Recent Notifications</h5>
          <div class="notifications-actions">
            <button class="action-btn" (click)="markAllAsRead()">
              <i class="pi pi-check-circle"></i>
              <span>Mark all read</span>
            </button>
            <button class="action-btn" (click)="clearAllNotifications()">
              <i class="pi pi-trash"></i>
              <span>Clear all</span>
            </button>
          </div>
        </div>

        <div class="notifications-list">
          @for (notification of recentNotifications; track notification.id) {
          <div class="notification-item" [class.unread]="!notification.read">
            <div class="notification-icon" [ngClass]="getNotificationIcon(notification.type)">
              <i [class]="getNotificationIconClass(notification.type)"></i>
            </div>
            <div class="notification-content">
              <div class="notification-header">
                <span class="notification-title">{{ notification.title }}</span>
                <span class="notification-time">{{ notification.time }}</span>
              </div>
              <p class="notification-message">{{ notification.message }}</p>
            </div>
            @if (!notification.read) {
            <div class="unread-indicator"></div>
            }
          </div>
          }
          @empty {
          <div class="empty-notifications">
            <i class="pi pi-bell-slash"></i>
            <h6>No new notifications</h6>
            <p>You're all caught up!</p>
          </div>
          }
        </div>

        <div class="notifications-footer">
          <a routerLink="/notifications" class="view-all-link" (click)="showProfileDialog = false">
            View all notifications
            <i class="pi pi-arrow-right"></i>
          </a>
        </div>
      </div>
      }
    </div>
  </div>
</p-dialog>

<!-- NOTIFICATION BELL DIALOG -->
<p-dialog [(visible)]="showNotificationDialog" [modal]="true" [draggable]="false" [resizable]="false" appendTo="body"
  [dismissableMask]="true" [showHeader]="false" styleClass="notification-dialog" [style]="{ 
      width: '90vw', 
    maxWidth: '89vw',
    minHeight: '85vh',
    maxHeight: '90vh',
    borderRadius: '20px', 
    overflow: 'hidden'
  }" maskStyleClass="backdrop-blur-sm bg-black/40" (onHide)="showNotificationDialog = false">

  <div class="dialog-container">
    <div class="notification-dialog-header">
      <h3>Notifications</h3>
      <button class="close-dialog-btn" (click)="showNotificationDialog = false">
        <i class="pi pi-times"></i>
      </button>
    </div>
    <app-notification-bell (close)="showNotificationDialog = false"></app-notification-bell>
  </div>
</p-dialog>

<!-- <div class="header-inner">
  <div class="header-left">
    <button class="menu-toggle-btn" (click)="toggleSidebar.emit()">
      <i class="pi pi-bars"></i>
    </button>
    <a routerLink="/dashboard" class="logo-link">
      <img src="assets/apex-infinity-logo.svg" alt="Apex Infinity" class="logo-image">
      <span class="logo-text">Apex Infinity</span>
    </a>
  </div>

  <div class="header-right">
    <button (click)="showNotificationdialog = true" class="notification-btn"
      [class.has-new]="recentNotifications && recentNotifications.length > 0" pTooltip="Notifications"
      tooltipPosition="bottom">
      <i class="pi pi-bell"></i>
      @if (recentNotifications && recentNotifications.length > 0) {
        <span class="notification-count">{{ recentNotifications.length }}</span>
      }
    </button>

    @if (currentUser) {
    <button class="user-profile-trigger" (click)="op.toggle($event)" pTooltip="Profile & Settings" tooltipPosition="bottom">
      <p-avatar [label]="getInitials(currentUser?.name)" shape="circle" size="normal"
        [style]="{'background-color': 'var(--accent-primary)', 'color': '#fff', 'font-weight': '600'}">
      </p-avatar>
      <div class="user-meta hidden md:flex">
        <span class="name">{{ currentUser?.name }}</span>
        <span class="role">{{ currentUser?.role.name || 'Admin' }}</span>
      </div>
      <i class="pi pi-chevron-down text-xs ml-1 transition-transform duration-200"
        [class.rotate-180]="op.overlayVisible"></i>
    </button>

    <p-popover #op appendTo="body" 
      [showTransitionOptions]="'250ms cubic-bezier(0.16, 1, 0.3, 1)'"
      [hideTransitionOptions]="'200ms cubic-bezier(0.4, 0, 0.2, 1)'" 
      styleClass="premium-popover-override">

      <div class="popover-container">
        Enhanced Header with User Info
        <div class="popover-header">
          <div class="user-profile-section">
            <p-avatar [label]="getInitials(currentUser?.name)" shape="circle" size="xlarge"
              [style]="{'background-color': 'var(--accent-primary)', 'color': '#fff', 'font-weight': '700'}">
            </p-avatar>
            <div class="user-info">
              <h3 class="user-name">{{ currentUser?.name }}</h3>
              <p class="user-email">{{ currentUser?.email }}</p>
              <div class="user-badges">
                <span class="role-badge">
                  <i class="pi pi-shield"></i>
                  {{ currentUser?.role.name || 'Admin' }}
                </span>
                <span class="status-badge">
                  <i class="pi pi-circle-fill"></i>
                  Online
                </span>
              </div>
            </div>
            <button class="edit-profile-btn" (click)="openProfile()">
              <i class="pi pi-pencil"></i>
            </button>
          </div>
        </div>

        Enhanced Tabs
        <div class="popover-tabs-container">
          <div class="popover-tabs">
            <div class="tab-indicator" [style.transform]="'translateX(' + (activeTab === 'settings' ? '0' : '100') + '%)'"></div>
            <button class="tab-btn" [class.active]="activeTab === 'settings'" (click)="activeTab = 'settings'">
              <i class="pi pi-cog"></i>
              <span>Settings</span>
            </button>
            <button class="tab-btn" [class.active]="activeTab === 'notifications'" (click)="activeTab = 'notifications'">
              <i class="pi pi-bell"></i>
              <span>Notifications</span>
              @if (recentNotifications.length) {
                <span class="notification-indicator">{{ recentNotifications.length }}</span>
              }
            </button>
          </div>
        </div>

        Scrollable Content Area
        <div class="popover-scroll-body" #scrollBody>
          @if (activeTab === 'settings') {
          <div class="settings-content">
            
            Theme Section
            <div class="section-card">
              <div class="section-header">
                <h5 class="section-title">
                  <i class="pi pi-palette"></i>
                  <span>Theme & Appearance</span>
                </h5>
                <div class="dark-mode-toggle">
                  <span class="toggle-label">Dark Mode</span>
                  <p-toggleButton [(ngModel)]="isDarkMode" 
                    onIcon="pi-moon" offIcon="pi pi-sun" 
                    [style]="{'width': '3.5rem', 'height': '1.75rem'}"
                    (onChange)="toggleDarkMode($event.checked)">
                  </p-toggleButton>
                </div>
              </div>

              Theme Presets Grid
              <div class="theme-presets-section">
                <h6 class="section-subtitle">Quick Presets</h6>
                <div class="theme-presets-grid">
                  @for (preset of themePresets; track preset.id) {
                  <div class="preset-card" 
                       [class.active]="activeThemeId === preset.id"
                       (click)="selectTheme(preset.id)">
                    <div class="preset-preview" [style.background]="preset.gradient">
                      <div class="preset-preview-content">
                        <div class="preview-bar"></div>
                        <div class="preview-bar short"></div>
                        <div class="preview-bar medium"></div>
                      </div>
                      @if (activeThemeId === preset.id) {
                      <div class="active-check">
                        <i class="pi pi-check"></i>
                      </div>
                      }
                    </div>
                    <span class="preset-name">{{ preset.name }}</span>
                  </div>
                  }
                </div>
              </div>

              Accent Colors
              <div class="accent-colors-section">
                <h6 class="section-subtitle">Accent Colors</h6>
                <div class="accent-colors-grid">
                  @for (color of accentColors; track color.name) {
                  <div class="color-option" (click)="setAccentColor(color.value)">
                    <div class="color-circle" [style.background]="color.value"></div>
                    <span class="color-name">{{ color.name }}</span>
                  </div>
                  }
                </div>
              </div>
            </div>

            Quick Actions
            <div class="section-card quick-actions-card">
              <h5 class="section-title">
                <i class="pi pi-bolt"></i>
                <span>Quick Actions</span>
              </h5>
              <div class="actions-grid">
                <button class="action-item" (click)="randomTheme()">
                  <div class="action-icon random-theme">
                    <i class="pi pi-random"></i>
                  </div>
                  <span>Random Theme</span>
                </button>
                <button class="action-item" (click)="resetToDefault()">
                  <div class="action-icon reset-default">
                    <i class="pi pi-replay"></i>
                  </div>
                  <span>Reset Default</span>
                </button>
                <button class="action-item" (click)="exportSettings()">
                  <div class="action-icon export-settings">
                    <i class="pi pi-download"></i>
                  </div>
                  <span>Export</span>
                </button>
                <button class="action-item" (click)="importSettings()">
                  <div class="action-icon import-settings">
                    <i class="pi pi-upload"></i>
                  </div>
                  <span>Import</span>
                </button>
              </div>
            </div>

            Account Management
            <div class="section-card account-section">
              <h5 class="section-title">
                <i class="pi pi-user"></i>
                <span>Account Management</span>
              </h5>
              <div class="account-links">
                <a routerLink="/profile" class="account-link" (click)="op.hide()">
                  <div class="link-icon profile">
                    <i class="pi pi-user-edit"></i>
                  </div>
                  <div class="link-content">
                    <span class="link-title">Profile Settings</span>
                    <span class="link-subtitle">Update personal information</span>
                  </div>
                  <i class="pi pi-chevron-right link-arrow"></i>
                </a>
                <a routerLink="/security" class="account-link" (click)="op.hide()">
                  <div class="link-icon security">
                    <i class="pi pi-shield"></i>
                  </div>
                  <div class="link-content">
                    <span class="link-title">Security</span>
                    <span class="link-subtitle">Password & 2FA settings</span>
                  </div>
                  <i class="pi pi-chevron-right link-arrow"></i>
                </a>
                <a routerLink="/billing" class="account-link" (click)="op.hide()">
                  <div class="link-icon billing">
                    <i class="pi pi-credit-card"></i>
                  </div>
                  <div class="link-content">
                    <span class="link-title">Billing</span>
                    <span class="link-subtitle">Manage subscription</span>
                  </div>
                  <i class="pi pi-chevron-right link-arrow"></i>
                </a>
              </div>
            </div>

            Sign Out Button
            <button class="signout-btn" (click)="logout(); op.hide()">
              <i class="pi pi-power-off"></i>
              <span>Sign Out</span>
            </button>

          </div>
          }

          @if (activeTab === 'notifications') {
          <div class="notifications-content">
            <div class="notifications-header">
              <h5>Recent Notifications</h5>
              <div class="notifications-actions">
                <button class="action-btn" (click)="markAllAsRead()">
                  <i class="pi pi-check-circle"></i>
                  <span>Mark all read</span>
                </button>
                <button class="action-btn" (click)="clearAllNotifications()">
                  <i class="pi pi-trash"></i>
                  <span>Clear all</span>
                </button>
              </div>
            </div>
            
            <div class="notifications-list">
              @for (notification of recentNotifications; track notification.id; let i = $index) {
              <div class="notification-item" [class.unread]="!notification.read">
                <div class="notification-icon" [ngClass]="getNotificationIcon(notification.type)">
                  <i [class]="getNotificationIconClass(notification.type)"></i>
                </div>
                <div class="notification-content">
                  <div class="notification-header">
                    <span class="notification-title">{{ notification.title }}</span>
                    <span class="notification-time">{{ notification.time }}</span>
                  </div>
                  <p class="notification-message">{{ notification.message }}</p>
                </div>
                @if (!notification.read) {
                <div class="unread-indicator"></div>
                }
              </div>
              }
              @empty {
              <div class="empty-notifications">
                <i class="pi pi-bell-slash"></i>
                <h6>No new notifications</h6>
                <p>You're all caught up!</p>
              </div>
              }
            </div>
            
            <div class="notifications-footer">
              <a routerLink="/notifications" class="view-all-link" (click)="op.hide()">
                View all notifications
                <i class="pi pi-arrow-right"></i>
              </a>
            </div>
          </div>
          }
        </div>

      </div>
    </p-popover>
   }
    @else {
    <a routerLink="/auth/login" class="login-btn">
      <i class="pi pi-sign-in"></i>
      <span>Login</span>
    </a>
    }

  </div>
</div>

Notification Dialog
<p-dialog [(visible)]="showNotificationdialog" [modal]="true" [draggable]="false" [resizable]="false" appendTo="body"
  [dismissableMask]="true" [showHeader]="false" styleClass="notification-dialog" [style]="{ 
    width: '90vw', 
    maxWidth: '500px',
    height: 'auto',
    maxHeight: '95vh',
    borderRadius: '16px', 
    overflow: 'hidden'
  }" maskStyleClass="backdrop-blur-sm bg-black/40" (onHide)="showNotificationdialog = false">

  <div class="dialog-container">
    <app-notification-bell (close)="showNotificationdialog = false"></app-notification-bell>
  </div>
</p-dialog> -->

<!-- <div class="header-inner">
  <div class="header-left">
    <button class="menu-toggle-btn" (click)="toggleSidebar.emit()">
      <i class="pi pi-bars"></i>
    </button>
    <img src="assets/apex-infinity-logo.svg" alt="Apex Infinity" class="logo-image">
    <a routerLink="/dashboard" class="logo-link">
      <span>Apex Infinity</span>
    </a>
  </div>

  <div class="header-right">
    <button (click)="showNotificationdialog = true" class="notification-btn"
      [class.has-new]="recentNotifications && recentNotifications.length > 0" pTooltip="Notifications"
      tooltipPosition="bottom">
      <i class="pi pi-bell text-lg"></i>
    </button>

    @if (currentUser) {
    <button class="user-profile-trigger" (click)="op.toggle($event)">
      <p-avatar [label]="getInitials(currentUser?.name)" shape="circle"
        [style]="{'background-color': 'var(--accent-primary)', 'color': '#fff', 'font-weight': '700'}">
      </p-avatar>
      <div class="user-meta hidden md:flex">
        <span class="name">{{ currentUser?.name }}</span>
        <span class="role">{{ currentUser?.role.name || 'Admin' }}</span>
      </div>
      <i class="pi pi-angle-down text-xs opacity-60 hidden md:block" style="color: var(--text-secondary)"></i>
    </button>

    <p-popover #op appendTo="body" [showTransitionOptions]="'150ms cubic-bezier(0.16, 1, 0.3, 1)'"
      [hideTransitionOptions]="'100ms cubic-bezier(0.4, 0, 0.2, 1)'" styleClass="enhanced-popover-override">

      <div class="popover-container glass-surface">


        <div class="popover-tabs-container">
          <div class="popover-tabs surface-elevated">
            <div class="tab-slider"
              [style.transform]="activeTab === 'settings' ? 'translateX(0%)' : 'translateX(100%)'">
            </div>

            <button class="tab-btn" [class.active]="activeTab === 'settings'" (click)="activeTab = 'settings'">
              <i class="pi pi-cog mr-2"></i>
              Settings
            </button>

            <button class="tab-btn" [class.active]="activeTab === 'notifications'"
              (click)="activeTab = 'notifications'">
              <i class="pi pi-bell mr-2"></i>
              Notifications
              @if (recentNotifications.length) {
              <span class="tab-badge animate-pulse">{{ recentNotifications.length }}</span>
              }
            </button>
          </div>
        </div>

        @if (activeTab === 'settings') {
        <div class="popover-content">


          <div class="user-header surface-interactive">
            <p-avatar [label]="getInitials(currentUser?.name)" styleClass="xl-avatar surface-elevated" shape="circle">
            </p-avatar>
            <div class="user-details">
              <h4 class="font-semibold text-primary">{{ currentUser?.name }}</h4>
              <span class="text-sm text-tertiary">{{ currentUser?.email }}</span>
              <span class="text-xs text-label mt-1">
                <i class="pi pi-shield mr-1"></i>
                Admin Access
              </span>
            </div>
          </div>


          <div class="theme-section">
            <div class="section-header">
              <div class="section-title">
                <i class="pi pi-palette mr-2"></i>
                <span>Theme & Appearance</span>
              </div>
              <p-toggleButton [(ngModel)]="isDarkMode" onIcon="pi-moon" offIcon="pi pi-sun" styleClass="enhanced-toggle"
                (onChange)="toggleDarkMode($event.checked)">
              </p-toggleButton>
            </div>


            <div class="theme-categories">
              @for (category of getThemesByCategory(); track category.name) {
              <div class="theme-category">
                <h5 class="category-title">
                  {{ category.name }}
                  <span class="category-count">{{ category.themes.length }}</span>
                </h5>
                <div class="theme-grid">
                  @for (theme of category.themes; track theme.id) {
                  <div class="theme-option-wrapper" [pTooltip]="theme.description" tooltipPosition="top">
                    <div class="theme-option" [style.background]="theme.gradient"
                      [class.active]="activeThemeId === theme.id" [class.border-accent]="activeThemeId === theme.id"
                      (click)="selectTheme(theme.id)">
                      @if (activeThemeId === theme.id) {
                      <div class="active-indicator">
                        <i class="pi pi-check-circle"></i>
                      </div>
                      }
                      <div class="theme-preview">
                        <div class="preview-bar"></div>
                        <div class="preview-bar short"></div>
                        <div class="preview-bar medium"></div>
                      </div>
                    </div>
                    <span class="theme-name">{{ theme.name }}</span>
                  </div>
                  }
                </div>
              </div>
              }
            </div>


            <div class="quick-actions">
              <button class="action-btn" (click)="randomTheme()">
                <i class="pi pi-random"></i>
                Random Theme
              </button>
              <button class="action-btn" (click)="resetToDefault()">
                <i class="pi pi-replay"></i>
                Reset
              </button>
            </div>
          </div>


          <div class="menu-section surface-elevated">
            <h6 class="section-title">Account Settings</h6>

            <a routerLink="/user/profile" class="menu-item surface-interactive" (click)="op.hide()">
              <div class="icon-box bg-blue-100 text-blue-600">
                <i class="pi pi-user-edit"></i>
              </div>
              <div class="item-text">
                <span class="label">Profile Settings</span>
                <span class="sub-label">Personal information & preferences</span>
              </div>
              <i class="pi pi-chevron-right arrow text-tertiary"></i>
            </a>

            <a routerLink="/user/security" class="menu-item surface-interactive" (click)="op.hide()">
              <div class="icon-box bg-green-100 text-green-600">
                <i class="pi pi-shield"></i>
              </div>
              <div class="item-text">
                <span class="label">Security</span>
                <span class="sub-label">Password, 2FA & sessions</span>
              </div>
              <i class="pi pi-chevron-right arrow text-tertiary"></i>
            </a>

            <a routerLink="/user/billing" class="menu-item surface-interactive" (click)="op.hide()">
              <div class="icon-box bg-purple-100 text-purple-600">
                <i class="pi pi-credit-card"></i>
              </div>
              <div class="item-text">
                <span class="label">Billing & Subscription</span>
                <span class="sub-label">Manage payments & plan</span>
              </div>
              <i class="pi pi-chevron-right arrow text-tertiary"></i>
            </a>

            <div class="divider"></div>

            <button class="menu-item danger surface-interactive" (click)="logout(); op.hide()">
              <div class="icon-box bg-red-100 text-red-600">
                <i class="pi pi-power-off"></i>
              </div>
              <div class="item-text">
                <span class="label font-semibold">Sign Out</span>
                <span class="sub-label">Log out from all devices</span>
              </div>
            </button>
          </div>

        </div>
        }

        @if (activeTab === 'notifications') {
        <div class="notification-wrapper">
          <div class="notification-header">
            <h5 class="font-semibold">Notifications</h5>
            <button class="clear-btn" (click)="clearAllNotifications()">
              Clear All
            </button>
          </div>
          <app-notification-bell></app-notification-bell>
        </div>
        }

      </div>
    </p-popover>
    }
    @else {
    <a routerLink="/auth/login" class="login-btn">Login</a>
    }

  </div>
</div>
<p-dialog [(visible)]="showNotificationdialog" [modal]="true" [draggable]="false" [resizable]="false" appendTo="body"
  [dismissableMask]="true" [showHeader]="false" styleClass="notification-dialog" [style]="{ 
    width: '90vw', 
    height: 'auto',
    minHeight: '80vh',
    maxHeight: '95vh',
    borderRadius: '16px', 
    overflow: 'hidden'
  }" maskStyleClass="backdrop-blur-sm bg-black/40" (onHide)="showNotificationdialog = false">

  <div class="dialog-container">
    <app-notification-bell (close)="showNotificationdialog = false"></app-notification-bell>
  </div>
</p-dialog> -->