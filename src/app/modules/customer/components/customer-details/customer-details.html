<div class="customer-page-container">
  <!-- === Customer Data === -->
  <div class="customer-details-card" *ngIf="customer(); else loadingSkeleton">
    <!-- === HEADER === -->
    <header class="details-header">
      <div class="header-left">
        <p-button
          icon="pi pi-arrow-left"
          styleClass="p-button-text p-button-rounded"
          routerLink="/customer">
        </p-button>

        <div class="header-info">
          <h2 class="form-title">{{ customer()?.name }}</h2>
          <p-tag
            [value]="customer()?.isActive ? 'Active' : 'Inactive'"
            [severity]="customer()?.isActive ? 'success' : 'danger'">
          </p-tag>
        </div>
      </div>

      <div class="header-actions">
        <p-button label="Edit" icon="pi pi-pencil" styleClass="p-button-outlined"></p-button>
        <p-button label="More" icon="pi pi-ellipsis-v" styleClass="p-button-text"></p-button>
      </div>
    </header>

    <p-divider></p-divider>

    <!-- === BODY === -->
    <div class="details-body">
      <!-- Sidebar -->
      <aside class="profile-sidebar">
        <p-avatar
          [image]="customer()?.avatar"
          [label]="getInitials(customer()?.name || '')"
          styleClass="profile-avatar"
          shape="circle">
        </p-avatar>

        <h3 class="profile-name">{{ customer()?.name }}</h3>
        <span class="profile-type">{{ customer()?.type | titlecase }}</span>

        <p-divider></p-divider>

        <div class="profile-contact">
          <div
            class="contact-card"
            *ngFor="let field of [
              { icon: 'pi-user', label: 'Contact Person', value: customer()?.contactPerson },
              { icon: 'pi-envelope', label: 'Email', value: customer()?.email },
              { icon: 'pi-phone', label: 'Phone', value: customer()?.phone },
              { icon: 'pi-mobile', label: 'Alt. Phone', value: customer()?.altPhone },
              { icon: 'pi-calendar', label: 'Member Since', value: formatDate(customer()?.createdAt) }
            ]">
            <i class="pi {{ field.icon }} contact-icon"></i>
            <div class="contact-content">
              <label>{{ field.label }}</label>
              <span>{{ field.value || 'N/A' }}</span>
            </div>
          </div>
        </div>
      </aside>

      <!-- Main Details -->
      <section class="main-details">
        <!-- === FINANCIAL OVERVIEW === -->
        <div class="info-section">
          <h4 class="section-title">Financial Overview</h4>
          <div class="info-grid">
            <div class="info-card" *ngFor="let item of [
              { label: 'Outstanding', value: formatCurrency(customer()?.outstandingBalance), highlight: true },
              { label: 'Credit Limit', value: formatCurrency(customer()?.creditLimit) },
              { label: 'Opening Balance', value: formatCurrency(customer()?.openingBalance) }
            ]">
              <label>{{ item.label }}</label>
              <span [class.outstanding]="item.highlight">{{ item.value }}</span>
            </div>
          </div>
        </div>

        <!-- === ADDRESS DETAILS === -->
        <div class="info-section">
          <h4 class="section-title">Address Information</h4>
          <div class="address-grid">
            <div class="info-card address" *ngFor="let addr of [
              { title: 'Billing Address', data: customer()?.billingAddress },
              { title: 'Shipping Address', data: customer()?.shippingAddress }
            ]">
              <h5>{{ addr.title }}</h5>
              <div *ngFor="let key of ['street', 'city', 'state', 'zipCode']" class="address-item">
                <label>{{ key | titlecase }}</label>
                <span>{{ addr.data?.[key] || 'N/A' }}</span>
              </div>
            </div>
          </div>
        </div>

        <!-- === OTHER DETAILS === -->
        <div class="info-section">
          <h4 class="section-title">Other Details</h4>
          <div class="info-grid">
            <div class="info-card" *ngFor="let f of [
              { label: 'GST Number', value: customer()?.gstNumber },
              { label: 'PAN Number', value: customer()?.panNumber },
              { label: 'Payment Terms', value: customer()?.paymentTerms }
            ]">
              <label>{{ f.label }}</label>
              <span>{{ f.value || 'N/A' }}</span>
            </div>
          </div>

          <div class="info-card">
            <label>Tags</label>
            <div class="tags-container" *ngIf="getFilteredTags() as filteredTags">
              <p-tag *ngFor="let tag of filteredTags" [value]="tag"></p-tag>
            </div>
          </div>

          <div class="info-card notes">
            <label>Notes</label>
            <p>{{ customer()?.notes || 'No notes provided.' }}</p>
          </div>
        </div>
      </section>
    </div>

    <!-- === FOOTER === -->
    <!-- <footer class="details-footer">
      <div class="footer-actions">
        <p-button label="Back to List" icon="pi pi-arrow-left" styleClass="p-button-text"></p-button>
        <p-button label="Edit Customer" icon="pi pi-pencil" styleClass="p-button-primary"></p-button>
      </div>
    </footer> -->
  </div>

  <!-- === SKELETON LOADER === -->
  <ng-template #loadingSkeleton>
    <div class="skeleton-wrapper">
      <p-skeleton height="2rem" width="50%" styleClass="mb-3"></p-skeleton>
      <p-skeleton height="15rem" width="100%" styleClass="mb-2"></p-skeleton>
      <p-skeleton height="15rem" width="100%" styleClass="mb-2"></p-skeleton>
      <p-skeleton height="15rem" width="100%"></p-skeleton>
    </div>
  </ng-template>
</div>


<!-- 
<div class="p-6"> 
  <div class="glass-card customer-details-card" *ngIf="customer(); else noCustomer">
    
    
    <div class="details-header">
      <div class="flex items-center gap-4">
        <p-button 
          icon="pi pi-arrow-left" 
          styleClass="p-button-text p-button-rounded"
          routerLink="/customer"> 
        </p-button>
        <h2 class="form-title">{{ customer()?.name }}</h2>
        <p-tag 
          [value]="customer()?.isActive ? 'Active' : 'Inactive'" 
          [severity]="customer()?.isActive ? 'success' : 'danger'">
        </p-tag>
      </div>
      <div class="header-actions">
        
        <p-button label="Edit Customer" icon="pi pi-pencil" styleClass="p-button-outlined"></p-button>
        <p-button label="More Actions" icon="pi pi-ellipsis-v" styleClass="p-button-text"></p-button>
      </div>
    </div>

    <p-divider></p-divider>

    
    <div class="details-body">

      
      <div class="profile-sidebar">
        <p-avatar 
          [image]="customer()?.avatar" 
          [label]="getInitials(customer()?.name || '')" 
          styleClass="profile-avatar"
          shape="circle">
        </p-avatar>

        <h3 class="profile-name">{{ customer()?.name }}</h3>
        <span class="profile-type">{{ customer()?.type | titlecase }}</span>
        
        <p-divider></p-divider>

        <div class="profile-contact">
          <div class="detail-field">
            <label>Contact Person</label>
            
            <span>{{ customer()?.contactPerson ? customer()?.contactPerson : 'N/A' }}</span>
          </div>
          <div class="detail-field">
            <label>Email</label>
            <span>{{ customer()?.email ? customer()?.email : 'N/A' }}</span>
          </div>
          <div class="detail-field">
            <label>Phone</label>
            <span>{{ customer()?.phone }}</span>
          </div>
          <div class="detail-field">
            <label>Alt. Phone</label>
            <span>{{ customer()?.altPhone ? customer()?.altPhone : 'N/A' }}</span>
          </div>
          
          <div class="detail-field">
            <label>Member Since</label>
            <span>{{ formatDate(customer()?.createdAt) }}</span>
          </div>
        </div>
      </div>

      
      <div class="main-details">
        
        
        <section class="detail-section">
          <h4 class="section-title">Financial Overview</h4>
          <div class="financial-grid">
            <div class="stat-card">
              <label>Outstanding</label>
              <span class="stat-value outstanding">{{ formatCurrency(customer()?.outstandingBalance) }}</span>
            </div>
            <div class="stat-card">
              <label>Credit Limit</label>
              <span class="stat-value">{{ formatCurrency(customer()?.creditLimit) }}</span>
            </div>
            <div class="stat-card">
              <label>Opening Balance</label>
              <span class="stat-value">{{ formatCurrency(customer()?.openingBalance) }}</span>
            </div>
          </div>
        </section>

        <p-divider></p-divider>

        
        <section class="detail-section">
          <h4 class="section-title">Address Information</h4>
          <div class="address-grid">
            
            
            <div class="address-card">
              <h5>Billing Address</h5>
              <div class="detail-field">
                <label>Street</label>
                <span>{{ customer()?.billingAddress?.street ? customer()?.billingAddress?.street : 'N/A' }}</span>
              </div>
              <div class="detail-field">
                <label>City</label>
                <span>{{ customer()?.billingAddress?.city ? customer()?.billingAddress?.city : 'N/A' }}</span>
              </div>
              <div class="detail-field">
                <label>State</label>
                <span>{{ customer()?.billingAddress?.state ? customer()?.billingAddress?.state : 'N/A' }}</span>
              </div>
              <div class="detail-field">
                <label>Zip Code</label>
                <span>{{ customer()?.billingAddress?.zipCode ? customer()?.billingAddress?.zipCode : 'N/A' }}</span>
              </div>
            </div>
            
            
            <div class="address-card">
              <h5>Shipping Address</h5>
              <div class="detail-field">
                <label>Street</label>
                <span>{{ customer()?.shippingAddress?.street ? customer()?.shippingAddress?.street : 'N/A' }}</span>
              </div>
              <div class="detail-field">
                <label>City</label>
                <span>{{ customer()?.shippingAddress?.city ? customer()?.shippingAddress?.city : 'N/A' }}</span>
              </div>
              <div class="detail-field">
                <label>State</label>
                <span>{{ customer()?.shippingAddress?.state ? customer()?.shippingAddress?.state : 'N/A' }}</span>
              </div>
              <div class="detail-field">
                <label>Zip Code</label>
                <span>{{ customer()?.shippingAddress?.zipCode ? customer()?.shippingAddress?.zipCode : 'N/A' }}</span>
              </div>
            </div>

          </div>
        </section>
        
        <p-divider></p-divider>

        
        <section class="detail-section">
          <h4 class="section-title">Other Details</h4>
          <div class="other-details-grid">
            <div class="detail-field">
              <label>GST Number</label>
              <span>{{ customer()?.gstNumber ? customer()?.gstNumber : 'N/A' }}</span>
            </div>
            <div class="detail-field">
              <label>PAN Number</label>
              <span>{{ customer()?.panNumber ? customer()?.panNumber : 'N/A' }}</span>
            </div>
            <div class="detail-field">
              <label>Payment Terms</label>
              <span>{{ customer()?.paymentTerms ? customer()?.paymentTerms : 'N/A' }}</span>
            </div>
            <div class="detail-field">
              <label>Tags</label>
              
              <div class="tags-container" *ngIf="getFilteredTags() as filteredTags; else noTags">
                <ng-container *ngIf="filteredTags.length > 0; else noTags">
                  <p-tag *ngFor="let tag of filteredTags" [value]="tag"></p-tag>
                </ng-container>
              </div>
              <ng-template #noTags><span>N/A</span></ng-template>
            </div>
            <div class="detail-field notes">
              <label>Notes</label>
              <p>{{ customer()?.notes ? customer()?.notes : 'No notes provided.' }}</p>
            </div>
          </div>
        </section>

      </div>
    </div>

  </div>
</div>


<ng-template #noCustomer>
  
  <div class="flex items-center justify-center p-8">
    <h3 *ngIf="!customer()">Loading customer details...</h3>
    
  </div>
</ng-template> -->