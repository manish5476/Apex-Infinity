<p-toast></p-toast>

<div class="list-page-container">

  <div class="list-header">
    <h2 class="list-title">
      <i class="pi pi-receipt text-[var(--accent-primary)]"></i>
      Transaction History
    </h2>
    <p-button label="Export CSV" icon="pi pi-download" styleClass="p-button-outlined"
      (onClick)="downloadCsv()">
    </p-button>
  </div>

  <div class="themed-card list-content-area">

    <div class="se-filter-bar">
      
      <div class="se-filter-field">
        <label for="dateRange">Date Range</label>
        <p-datepicker 
          id="dateRange"
          [(ngModel)]="rangeDates" 
          selectionMode="range" 
          [readonlyInput]="true"
          placeholder="Start - End"
          [showIcon]="true"
          appendTo="body"
          (onClose)="applyFilters()"> </p-datepicker>
      </div>

      <div class="se-filter-field">
        <label for="type">Type</label>
        <p-select (onChange)="applyFilters()" id="type" [options]="transactionTypes" 
          [(ngModel)]="filterParams.type"
          [showClear]="true" placeholder="Select Type" appendTo="body">
        </p-select>
      </div>

      <div class="se-filter-field">
        <label for="effect">Effect</label>
        <p-select (onChange)="applyFilters()" id="effect" [options]="transactionEffects" 
          [(ngModel)]="filterParams.effect"
          [showClear]="true" placeholder="Credit/Debit" appendTo="body">
        </p-select>
      </div>

      <div class="se-filter-field">
        <label for="search">Search</label>
        <input (keydown.enter)="applyFilters()" (blur)="applyFilters()" id="search" 
          type="text" pInputText [(ngModel)]="filterParams.search" 
          placeholder="Desc or Ref Number" />
      </div>

      <div class="se-filter-actions">
        <p-button label="Reset" icon="pi pi-refresh" styleClass="p-button-outlined"
          (onClick)="resetFilters()">
        </p-button>
      </div>
    </div>

    <div class="list-grid-wrapper">
      <app-shared-grid 
        [data]="data" 
        [gridHeight]="'210px'" 
        [headerFilter]="false"
        [rowSelectionMode]="rowSelectionMode" 
        [GridName]="'Transactions'" 
        [column]="column"
        (gridReady)="onGridReady($event)"
        (scrolledToBottom)="onScrolledToBottom($event)">
      </app-shared-grid>
    </div>
  </div>
</div>