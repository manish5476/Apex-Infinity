
.invoice-wrapper {
  width: 100%;
  max-width: 100%;
  /* The "Zoomed Out" Effect */
  transform: scale(0.95);
  transform-origin: top center;
  font-family: var(--font-body);
  color: var(--text-primary);
}

/* --- Main Card Panel --- */
.invoice-panel {
  background: var(--bg-primary);
  border-radius: var(--ui-border-radius-xl);
  box-shadow: var(--shadow-xl); /* Outstanding depth */
  border: 1px solid var(--border-primary);
  overflow: hidden;
  display: flex;
  flex-direction: column;
  height: 90vh; /* Viewport fit */
}

/* --- Header --- */
.panel-header {
  padding: var(--spacing-xl) var(--spacing-2xl);
  background: var(--bg-primary);
  border-bottom: 1px solid var(--border-primary);
  display: flex;
  justify-content: space-between;
  align-items: center;

  h1 {
    font-family: var(--font-heading);
    font-size: var(--font-size-2xl);
    font-weight: 700;
    letter-spacing: -0.5px;
    margin: 0;
  }

  .meta-text {
    font-size: var(--font-size-xs);
    color: var(--text-secondary);
    margin-top: var(--spacing-xs);
    font-weight: 500;
  }
}

/* --- Body Scroll Area --- */
.panel-body {
  flex: 1;
  overflow-y: auto;
  padding: var(--spacing-2xl);
  background: var(--bg-secondary); /* Subtle contrast */
}

/* --- Section Cards --- */
.section-card {
  background: var(--bg-primary);
  border: 1px solid var(--border-primary);
  border-radius: var(--ui-border-radius-lg);
  padding: var(--spacing-xl);
  box-shadow: var(--shadow-sm);
  margin-bottom: var(--spacing-xl);
  transition: var(--transition-base);

  &:hover {
    box-shadow: var(--shadow-md);
    border-color: #cbd5e1;
  }
}

/* --- Labels & Inputs --- */
label {
  display: block;
  font-size: var(--font-size-xs);
  font-weight: 600;
  text-transform: uppercase;
  letter-spacing: 0.5px;
  color: var(--text-secondary);
  margin-bottom: var(--spacing-sm);
}

/* Override PrimeNG for Compactness */
::ng-deep .p-inputtext, 
::ng-deep .p-dropdown, 
::ng-deep .p-inputnumber-input {
  font-size: var(--font-size-sm) !important;
  padding: var(--spacing-sm) var(--spacing-md) !important;
  border-radius: var(--ui-border-radius) !important;
}

/* --- Data Table --- */
.invoice-table {
  width: 100%;
  border-collapse: separate;
  border-spacing: 0;
  font-size: var(--font-size-sm);

  thead th {
    background: var(--bg-ternary);
    color: var(--text-secondary);
    font-weight: 600;
    text-transform: uppercase;
    font-size: var(--font-size-xs);
    padding: var(--spacing-md);
    border-bottom: 1px solid var(--border-primary);
    text-align: left;
    
    &:first-child { border-radius: var(--ui-border-radius-lg) 0 0 0; }
    &:last-child { border-radius: 0 var(--ui-border-radius-lg) 0 0; }
  }

  tbody td {
    padding: var(--spacing-sm) var(--spacing-md);
    border-bottom: 1px solid var(--border-secondary);
    vertical-align: middle;
    transition: background-color 0.2s;
  }

  tbody tr:hover td {
    background-color: var(--bg-ternary);
  }
}

/* --- Footer Totals --- */
.totals-section {
  background: var(--bg-primary);
  border-radius: var(--ui-border-radius-lg);
  padding: var(--spacing-xl);
  border: 1px solid var(--border-primary);
  box-shadow: var(--shadow-md);

  .total-row {
    display: flex;
    justify-content: space-between;
    margin-bottom: var(--spacing-sm);
    font-size: var(--font-size-sm);
    color: var(--text-secondary);

    &.grand-total {
      margin-top: var(--spacing-md);
      padding-top: var(--spacing-md);
      border-top: 2px dashed var(--border-secondary);
      font-size: var(--font-size-xl);
      font-weight: 800;
      color: var(--text-primary);
      
      .amount {
        color: var(--accent-primary);
      }
    }
  }
}

/* --- Sticky Footer --- */
.panel-footer {
  padding: var(--spacing-lg) var(--spacing-2xl);
  background: var(--bg-primary);
  border-top: 1px solid var(--border-primary);
  display: flex;
  justify-content: space-between;
  align-items: center;
  z-index: var(--z-sticky);
}

/* --- Utility Helpers --- */
.text-mono { font-family: var(--font-mono); }
.stock-badge {
  font-size: var(--font-size-xs);
  padding: 2px 6px;
  border-radius: 4px;
  font-weight: 600;
  
  &.in-stock { background: #dcfce7; color: #166534; }
  &.low-stock { background: #fee2e2; color: #991b1b; }
}

// /* ==============================================
//    INVOICE FORM COMPONENT
//    - Using canonical theme tokens
//    ============================================== */

// :host {
//   display: block;
//   width: 100%;
//   height: 100%;
// }

// /* === Main Wrapper === */
// .customer-wrapper {
//   width: 100%;
//   height: 100%;
//   overflow: hidden; // This holds the layout
//   display: flex;
//   justify-content: center;
//   background: var(--bg-primary);
//   padding: var(--spacing-xl);
// }

// .customer-container {
//   width: 100%;
//   max-width: 100%;
// }

// /* === Form Panel === */
// .customer-form-panel {
//   display: flex;
//   flex-direction: column;
//   width: 100%;
//   height: 100%;
//   background: var(--bg-secondary);
//   border-radius: var(--ui-border-radius-lg);
//   box-shadow: var(--shadow-md);
//   overflow: hidden;
//   border: var(--ui-border-width) solid var(--border-primary);
// }

// .customer-form-layout {
//   display: flex;
//   flex-direction: column;
//   height: 100%;
// }

// /* === 1. Sticky Header === */
// .customer-form-header {
//   padding: var(--spacing-lg) var(--spacing-xl);
//   background: var(--bg-secondary);
//   border-bottom: var(--ui-border-width) solid var(--border-primary);
//   flex-shrink: 0;
//   z-index: 10;

//   .form-title {
//     font-size: var(--font-size-2xl);
//     font-weight: 600;
//     color: var(--text-primary);
//     margin: 0;
//   }
//   .form-subtitle {
//     font-size: var(--font-size-sm);
//     color: var(--text-secondary);
//     margin: 0;
//   }
//   .req {
//     color: var(--color-error);
//   }
// }

// /* === 2. Scrollable Body === */
// .customer-form-body {
//   flex: 1; // Grow to fill space
//   overflow-y: auto; // This is the scrollable part
//   padding: var(--spacing-xl);
//   background: var(--bg-primary);
//   display: flex;
//   flex-direction: column;
//   gap: var(--spacing-lg);
// }

// /* === 3. Sticky Footer === */
// .customer-form-footer {
//   background: var(--bg-secondary);
//   border-top: var(--ui-border-width) solid var(--border-primary);
//   padding: var(--spacing-lg) var(--spacing-xl);
//   display: flex;
//   justify-content: flex-end;
//   gap: var(--spacing-md);
//   flex-shrink: 0;
//   z-index: 10;
// }

// /* === Form Group Styling === */
// .form-group {
//   display: flex;
//   flex-direction: column;
//   gap: var(--spacing-sm);

//   label {
//     font-size: var(--font-size-xs);
//     color: var(--text-label);
//     text-transform: uppercase;
//     font-weight: 500;
//   }
//   .req {
//     color: var(--color-error);
//   }
// }

// /* 4-column grid */
// .form-grid-4 {
//   display: grid;
//   grid-template-columns: repeat(auto-fit, minmax(220px, 1fr));
//   gap: var(--spacing-lg);
// }

// /* 3-column grid */
// .form-grid-3 {
//   display: grid;
//   grid-template-columns: repeat(auto-fit, minmax(180px, 1fr));
//   gap: var(--spacing-lg);
// }

// /* === Invoice Items Styling === */
// .items-container {
//   display: flex;
//   flex-direction: column;
//   gap: 1rem;
//   padding: var(--spacing-lg);
//   background: var(--bg-secondary); // Use secondary bg to contain items
//   border-radius: var(--ui-border-radius);
//   border: var(--ui-border-width) solid var(--border-primary);
// }

// .item-grid-header,
// .item-grid {
//   display: grid;
//   /* Product | HSN | Qty | Price | Disc | Tax | Total | Del */
//   grid-template-columns: 3fr 1fr 0.8fr 1fr 1fr 0.8fr 1fr 0.5fr;
//   gap: var(--spacing-lg);
//   align-items: flex-start;
// }

// .item-grid-header {
//   padding: 0 0.5rem 0.5rem;
//   border-bottom: 1px solid var(--border-primary);
//   label {
//     font-size: var(--font-size-xs);
//     color: var(--text-label);
//     font-weight: 600;
//     text-transform: uppercase;
//   }
// }

// .line-total {
//   font-weight: 600;
//   color: var(--text-primary);
//   font-size: var(--font-size-base);
//   padding-top: var(--spacing-md); // Align with inputs
//   text-align: right;
//   display: block;
//   white-space: nowrap;
// }

// .col-span-3 {
//   grid-column: span 3;
// }

// .align-bottom {
//   display: flex;
//   flex-direction: column;
//   justify-content: flex-end;
//   padding-bottom: 0.2rem;
//   height: 100%; // Ensure it aligns
// }

// @media (max-width: 1200px) {
//   .item-grid-header {
//     display: none; /* Hide header on smaller, labels in form are enough */
//   }
//   .item-grid {
//     grid-template-columns: 1fr 1fr; /* 2-column layout */
    
//     .col-span-3 {
//       grid-column: 1 / -1; /* Product spans full width */
//     }
//   }
// }

// /* === Totals Grid === */
// .totals-notes-grid {
//   display: grid;
//   grid-template-columns: 2fr 1fr;
//   gap: var(--spacing-xl);
//   margin-top: var(--spacing-lg);
  
//   @media (max-width: 900px) {
//     grid-template-columns: 1fr;
//   }
// }

// /* Totals Card */
// .totals-card {
//   padding: var(--spacing-lg);
//   background: var(--bg-secondary);
//   border-radius: var(--ui-border-radius);
//   border: var(--ui-border-width) solid var(--border-primary);
  
//   .total-row {
//     display: flex;
//     justify-content: space-between;
//     align-items: center;
//     padding: var(--spacing-sm) 0;
//     label {
//       font-size: var(--font-size-base);
//       color: var(--text-secondary);
//       font-weight: 500;
//     }
//     span {
//       font-size: var(--font-size-base);
//       color: var(--text-primary);
//       font-weight: 600;
//       white-space: nowrap;
//     }
//     &.grand-total {
//       label, span {
//         font-size: var(--font-size-lg);
//         font-weight: 700;
//       }
//     }
//     &.balance-due {
//       margin-top: var(--spacing-sm);
//       padding: var(--spacing-md);
//       background: var(--bg-primary); // Contrast from card
//       border-radius: var(--ui-border-radius-sm);
//       label, span {
//         font-size: var(--font-size-xl);
//         font-weight: 700;
//         color: var(--accent-primary);
//       }
//     }
//   }
// }


// /* === Validation & Component Overrides === */
// :host ::ng-deep {
//   // Ensure all form components take full width
//   :is(p-select, .p-inputnumber, .p-inputtextarea, .p-fileupload, p-datepicker) {
//     width: 100%;
//   }

//   // Set input backgrounds to contrast
//   :is(.p-inputtext, .p-inputnumber-input, .p-textarea, .p-datepicker-input) {
//     background: var(--bg-ternary);
//     color: var(--text-primary);
//     width: 100%;
//   }
  
//   .p-select {
//     background: var(--bg-ternary);
//     .p-select-label {
//       color: var(--text-primary);
//     }
//   }

//   // Style invalid touched form fields
//   .ng-invalid.ng-touched {
//     :is(.p-inputtext, p-select, .p-inputnumber, .p-inputtextarea, p-datepicker) {
//       border-color: var(--color-error);
//     }
//   }

//   // Ensure dropdown panels match theme
//   .p-select-panel {
//     background: var(--bg-secondary);
//     border: var(--ui-border-width) solid var(--border-primary);
    
//     .p-select-item {
//       color: var(--text-secondary);
//       &:hover {
//         background: var(--bg-ternary);
//         color: var(--text-primary);
//       }
//     }
//     .p-select-item.p-highlight {
//       background: var(--accent-focus);
//       color: var(--accent-primary);
//     }
//   }
  
//   // Datepicker panel
//   .p-datepicker-panel {
//      background: var(--bg-secondary);
//      border: var(--ui-border-width) solid var(--border-primary);
     
//      .p-datepicker-header {
//        background: var(--bg-ternary);
//        color: var(--text-primary);
//        border-bottom-color: var(--border-primary);
       
//        .p-datepicker-prev, .p-datepicker-next {
//          color: var(--text-secondary);
//          &:hover {
//            background: var(--bg-primary);
//          }
//        }
//      }
     
//      .p-datepicker-calendar {
//        td span {
//          color: var(--text-primary);
//          &:hover {
//            background: var(--bg-ternary);
//          }
//        }
//        td.p-datepicker-today span {
//          background: var(--accent-focus);
//          color: var(--accent-primary);
//        }
//      }
//   }
// }

// .items-table {
//     width: 100%;
//     border-collapse: collapse;
//     border-spacing: 0;
//     background: var(--bg-secondary);
//     border-radius: var(--ui-border-radius);
//     overflow: hidden;

//     th, td {
//         padding: .75rem;
//         text-align: left;
//         border-bottom: 1px solid var(--border-primary);
//         vertical-align: middle;
//     }

//     th {
//         background: var(--bg-ternary);
//         font-size: var(--font-size-xs);
//         text-transform: uppercase;
//         color: var(--text-label);
//         font-weight: 600;
//         white-space: nowrap;
//     }
// }

// .col-product {
//     min-width: 250px;
// }

// :host ::ng-deep {
//     .p-select, .p-inputnumber, .p-inputtext {
//         width: 100%;
//     }
// }


// // /* Use the full-width form layout */
// // :host {
// //   display: block;
// // }

// // /* Override container to be wider for invoices */
// // .invoice-form-container {
// //   max-width: 1600px;
// //   width: 95%;

// //   /* Remove the banner on this form */
// //   .customer-banner {
// //     display: none;
// //   }
// // }

// // /* 4-column grid */
// // .form-grid-4 {
// //   display: grid;
// //   grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
// //   gap: 0.85rem;
// // }

// // /* 3-column grid */
// // .form-grid-3 {
// //   display: grid;
// //   grid-template-columns: repeat(auto-fit, minmax(180px, 1fr));
// //   gap: 0.85rem;
// // }

// // .align-bottom {
// //   display: flex;
// //   flex-direction: column;
// //   justify-content: flex-end;
// //   padding-bottom: 0.2rem;
// // }

// // /* --- Invoice Items --- */
// // .items-container {
// //   display: flex;
// //   flex-direction: column;
// //   gap: 1rem;
// //   padding: 1rem;
// //   background: var(--theme-bg-ternary);
// //   border-radius: var(--ui-border-radius);
// // }

// // .item-grid-header,
// // .item-grid {
// //   display: grid;
// //   /* Product | HSN | Qty | Price | Disc | Tax | Total | Del */
// //   grid-template-columns: 3fr 1fr 0.8fr 1fr 1fr 0.8fr 1fr 0.5fr;
// //   gap: 0.85rem;
// //   align-items: flex-start;
// // }

// // .item-grid-header {
// //   padding: 0 0.5rem 0.5rem;
// //   border-bottom: 1px solid var(--theme-border-primary);
// //   label {
// //     font-size: var(--font-size-sm);
// //     color: var(--theme-text-label);
// //     font-weight: 600;
// //   }
// // }

// // .line-total {
// //   font-weight: 600;
// //   color: var(--theme-text-primary);
// //   font-size: var(--font-size-base);
// //   padding-top: 0.5rem; /* Align with inputs */
// //   text-align: right;
// //   display: block;
// // }

// // .col-span-3 {
// //   grid-column: span 3;
// // }

// // @media (max-width: 1024px) {
// //   .item-grid-header {
// //     display: none; /* Hide header on mobile, labels in form are enough */
// //   }
// //   .item-grid {
// //     grid-template-columns: 1fr 1fr; /* 2-column layout */
    
// //     .col-span-3 {
// //       grid-column: 1 / -1; /* Product spans full width */
// //     }
// //   }
// // }

// // /* --- Totals Grid --- */
// // .totals-notes-grid {
// //   display: grid;
// //   grid-template-columns: 2fr 1fr;
// //   gap: var(--spacing-lg);
// //   margin-top: var(--spacing-lg);
  
// //   @media (max-width: 768px) {
// //     grid-template-columns: 1fr;
// //   }
// // }

// // /* Copied from invoice-details for consistency */
// // .totals-card {
// //   padding: var(--spacing-md);
// //   background: var(--theme-bg-ternary);
// //   border-radius: var(--ui-border-radius);
  
// //   .total-row {
// //     display: flex;
// //     justify-content: space-between;
// //     align-items: center;
// //     padding: var(--spacing-sm) 0;
// //     label {
// //       font-size: var(--font-size-base);
// //       color: var(--theme-text-secondary);
// //       font-weight: 500;
// //     }
// //     span {
// //       font-size: var(--font-size-base);
// //       color: var(--theme-text-primary);
// //       font-weight: 600;
// //     }
// //     &.grand-total {
// //       label, span {
// //         font-size: var(--font-size-lg);
// //         font-weight: 700;
// //       }
// //     }
// //     &.balance-due {
// //       margin-top: var(--spacing-sm);
// //       padding: var(--spacing-md);
// //       background: var(--theme-bg-secondary);
// //       border-radius: var(--ui-border-radius-sm);
// //       label, span {
// //         font-size: var(--font-size-xl);
// //         font-weight: 700;
// //         color: var(--theme-accent-primary);
// //       }
// //     }
// //   }
// // }