<p-toast></p-toast>

<div class="page-container">

  <!-- 1. HEADER -->
  <header class="setup-header">
    <div class="icon-box">
      <i class="pi pi-building"></i>
    </div>
    <div class="header-text">
      <h1>Setup Organization</h1>
      <p>Register your enterprise profile, branch details, and administrative access.</p>
    </div>
  </header>

  <!-- 2. FORM CONTENT -->
  <main class="setup-content">
    <!-- Added style="max-width: 100%" to force full width layout -->
    <form [formGroup]="organizationForm" class="form-wrapper" style="max-width: 100%">

      <!-- SECTION 1: ORGANIZATION DETAILS -->
      <section class="form-section">
        <div class="section-header">
          <h3><i class="pi pi-id-card"></i> Organization Profile</h3>
          <span class="section-desc">Basic identification and contact information for your company.</span>
        </div>

        <div class="form-grid">
          <div class="form-group">
            <label>Organization Name <span class="req">*</span></label>
            <input pInputText formControlName="organizationName" placeholder="Ex: Apex Innovations"
              (blur)="generateShopId()" />
          </div>

          <div class="form-group">
            <label>Unique Shop ID <span class="req">*</span></label>
            <input pInputText formControlName="uniqueShopId" placeholder="Ex: APEX-001"
              style="text-transform: uppercase" />
            <small class="hint">Auto-generated ID for system referencing.</small>
          </div>

          <div class="form-group">
            <label>Primary Email <span class="req">*</span></label>
            <input pInputText type="email" formControlName="primaryEmail" placeholder="contact@company.com" />
          </div>

          <div class="form-group">
            <label>Primary Phone <span class="req">*</span></label>
            <input pInputText formControlName="primaryPhone" placeholder="+91 98765 43210" />
          </div>

          <div class="form-group">
            <label>GST Number</label>
            <input pInputText formControlName="gstNumber" placeholder="22AAAAA0000A1Z5"
              style="text-transform: uppercase" />
          </div>
        </div>
      </section>

      <!-- SECTION 2: MAIN BRANCH -->
      <section class="form-section">
        <div class="section-header">
          <h3><i class="pi pi-map-marker"></i> Headquarters Location</h3>
          <span class="section-desc">Details for your primary operating branch.</span>
        </div>

        <div class="form-grid">
          <div class="form-group span-2">
            <label>Branch Name <span class="req">*</span></label>
            <input pInputText formControlName="mainBranchName" placeholder="Ex: Head Office" />
          </div>

          <!-- Nested Address Group -->
          <ng-container formGroupName="mainBranchAddress">
            <div class="form-group span-2">
              <label>Street Address <span class="req">*</span></label>
              <input pInputText formControlName="street" placeholder="123 Business Park" />
            </div>

            <div class="form-group">
              <label>City <span class="req">*</span></label>
              <input pInputText formControlName="city" placeholder="New York" />
            </div>

            <div class="form-group">
              <label>State <span class="req">*</span></label>
              <input pInputText formControlName="state" placeholder="NY" />
            </div>

            <div class="form-group">
              <label>Zip Code <span class="req">*</span></label>
              <input pInputText formControlName="zipCode" placeholder="10001" />
            </div>
          </ng-container>
        </div>
      </section>

      <!-- SECTION 3: ADMIN ACCOUNT -->
      <section class="form-section highlight">
        <div class="section-header">
          <h3><i class="pi pi-shield"></i> Super Admin Access</h3>
          <span class="section-desc">Credentials for the primary owner of this organization.</span>
        </div>

        <div class="form-grid">
          <div class="form-group">
            <label>Owner Name <span class="req">*</span></label>
            <input pInputText formControlName="ownerName" placeholder="Full Name" />
          </div>

          <div class="form-group">
            <label>Login Email <span class="req">*</span></label>
            <input pInputText type="email" formControlName="ownerEmail" placeholder="admin@company.com" />
          </div>

          <div class="form-group">
            <label>Password <span class="req">*</span></label>
            <p-password formControlName="ownerPassword" [toggleMask]="true" [feedback]="true"
              promptLabel="Enter a strong password" weakLabel="Weak" mediumLabel="Medium" strongLabel="Strong"
              placeholder="Min 8 characters">
            </p-password>
          </div>
        </div>
      </section>

    </form>
  </main>

  <!-- 3. FOOTER -->
  <footer class="setup-footer">
    <!-- Added style="max-width: 100%" to ensure footer actions align with full width -->
    <div class="footer-content" style="max-width: 100%">
      <button pButton type="button" label="Back to Login" icon="pi pi-arrow-left"
        class="p-button-text p-button-secondary" routerLink="/auth/login"></button>
      <button pButton type="button" label="Create Organization" icon="pi pi-check" class="p-button-primary"
        [loading]="isLoading()" (click)="onSubmit()"></button>
    </div>
  </footer>
</div>