<div class="timeline-container">
  <div class="timeline-header">
    <div class="nav-controls glass-panel">
      <button pButton pRipple icon="pi pi-chevron-left" class="p-button-text p-button-rounded nav-btn small" 
              (click)="changeMonth(-1)"></button>
      
      <span class="current-month" (click)="jumpToToday()" pTooltip="Jump to Today" tooltipPosition="bottom">
        {{ currentMonthName() }}
      </span>
      
      <button pButton pRipple icon="pi pi-chevron-right" class="p-button-text p-button-rounded nav-btn small" 
              (click)="changeMonth(1)"></button>
    </div>

    </div>

  <div class="timeline-strip" #scrollContainer>
    
    @if (isLoading()) {
      <div class="skeleton-wrapper">
        @for (i of [1,2,3,4,5,6,7,8,9,10,11,12]; track i) {
          <div class="day-card skeleton">
            <p-skeleton width="20px" height="10px" styleClass="mb-2"></p-skeleton>
            <p-skeleton width="24px" height="24px" shape="circle"></p-skeleton>
          </div>
        }
      </div>
    } 
    
    @else {
      @for (day of timelineDays(); track day.date) {
        <div 
          class="day-card glass-card" 
          [class.active]="isSameDate(day.date, selectedDate())"
          [class.today]="isToday(day.date)"
          [class.has-activity]="day.count > 0"
          (click)="selectDate(day.date)"
          pRipple>

          <span class="day-name">{{ day.dayName }}</span>
          
          <span class="day-num">{{ day.dayNum }}</span>

          <div class="indicators">
             @if (day.count > 0) {
                <div class="dot-group">
                  @for (i of getDotArray(day.count); track i) {
                    <div class="dot" [class.primary]="day.intensity >= 2"></div>
                  }
                  @if (day.count > 3) { <div class="plus-indicator">+</div> }
                </div>
             }
          </div>

          <div class="tooltip-trigger" 
               [pTooltip]="getTooltipText(day)" 
               tooltipPosition="top"></div>
        </div>
      }
    }
  </div>
</div>
