<div class="dashboard-wrapper">

  <!-- Sticky Header -->
  <header class="dashboard-header">
    <div>
      <h2>Executive Overview</h2>
      <p>Performance snapshot â€” revenue, expenses, risk and growth.</p>
    </div>

    <div class="actions">
      <div class="preset-group">
        <button [class.active]="activePreset() === 'all'" (click)="applyPreset('all')">All Time</button>
        <button [class.active]="activePreset() === 'month'" (click)="applyPreset('month')">This Month</button>
      </div>

      <p-datepicker [(ngModel)]="dateRangeModel" selectionMode="range" placeholder="Custom Range"
        inputStyleClass="date-input" (onSelect)="onDateChange()">
      </p-datepicker>

      <button class="icon-btn" (click)="facade.load()">
        <i class="pi pi-refresh"></i>
      </button>
    </div>
  </header>


  <!-- KPI Section -->
  <section class="kpi-grid" *ngIf="facade.kpi()">
    <kpi-card label="Revenue" icon="pi-wallet" [value]="facade.kpi()?.revenue" [growth]="facade.kpi()?.revenueGrowth">
    </kpi-card>

    <kpi-card label="Net Profit" icon="pi-chart-line" [value]="facade.kpi()?.profit"
      [growth]="facade.kpi()?.profitGrowth">
    </kpi-card>

    <kpi-card label="Outstanding Receivable" icon="pi-exclamation-circle" [value]="facade.kpi()?.receivables">
    </kpi-card>

    <kpi-card label="Inventory Value" icon="pi-box" [value]="facade.inventory()?.totalValue">
    </kpi-card>
  </section>


  <!-- Chart Zone -->
  <section class="chart-grid">
    <revenue-chart [data]="facade.timelineChart()"></revenue-chart>

    <div class="side-stack">
      <payment-donut [data]="facade.paymentModes()"></payment-donut>
      <div class="placeholder"></div>
    </div>
  </section>


  <!-- Branch Comparison-->
  <section class="chart-wide">
    <branch-comparison [data]="facade.branchComparison()"></branch-comparison>
  </section>


  <!-- Top Lists -->
  <section class="bottom-grid">
    <div class="grid-lists">
      <top-products [products]="facade.leaders()?.topProducts ?? null"></top-products>
      <top-customers [customers]="facade.leaders()?.topCustomers ?? null"></top-customers>
    </div>
  </section>


  <!-- Insights Panels -->
  <section class="lower-widgets">
    <risk-panel [risk]="facade.risk()"></risk-panel>
    <inventory-status [inventory]="facade.inventory()"></inventory-status>
    <segmentation-chart [segmentation]="facade.segmentation()"></segmentation-chart>
  </section>


  <!-- Activity Log -->
  <section class="timeline-section">
    <!-- <activity-log [events]="facade.security() ?? []"></activity-log> -->
  </section>

</div>